<!DOCTYPE html>
<html>
<head>
    <title>Processing</title>
    <script>
        function updateProgress() {
            fetch('/progress')
                .then(response => response.json())
                .then(data => {
                    if (data.progress === -1) {
                        document.getElementById('progress').innerText = data.error;
                        document.getElementById('progressBar').style.display = 'none';
                    } else {
                        document.getElementById('progress').innerText = data.progress + '%';
                        document.getElementById('progressBar').value = data.progress;
                        if (data.progress < 100) {
                            setTimeout(updateProgress, 1000);
                        } else {
                            document.getElementById('downloadLink').style.display = 'block';
                        }
                    }
                });
        }
        window.onload = updateProgress;
    </script>
</head>
<body>
    <h1>Processing Defects</h1>
    <progress id="progressBar" value="0" max="100"></progress>
    <p id="progress">0%</p>
    <a id="downloadLink" href="/download" style="display:none;">Download Processed File</a>
</body>
</html>